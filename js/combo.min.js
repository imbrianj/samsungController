/* 20151216 */
SB=function(){"use strict";return{version:20151007,cancelBubble:function(a){a=a||window.event,a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},isChildOf:function(a,b){if(b===a)return!1;for(;a&&a!==b&&a!==document.body;)a=a.parentNode;return a===b},event:{list:[],add:function(a,b,c,d){d=d||!1,a.addEventListener?a.addEventListener(b,c,d):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c,SB.event.list.push([a,b,c])},remove:function(a,b,c,d){d=d||!1;var e=0;for(a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null,e;e<SB.event.list.length;e+=1)if(SB.event.list[e]&&SB.event.list[e]&&SB.event.list[e][0]===a&&SB.event.list[e][1]===b&&SB.event.list[e][2]===c){SB.event.list.splice(e,1);break}},removeAll:function(a){a=a||document;var b=SB.event.list.length-1;for(b;b>=0;b-=1)SB.event.list[b]&&(SB.event.list[b][0]===a||a===document)&&SB.event.remove(SB.event.list[b][0],SB.event.list[b][1],SB.event.list[b][2])}},getTarget:function(a){return a=a||window.event,a.target?a.target:a.srcElement},hasAttribute:function(a,b,c){return a[b]?a[b].match(new RegExp("(\\s|^)"+c+"(\\s|$)"))?!0:!1:void 0},hasClass:function(a,b){var c=!1;return a&&a.className&&(c=SB.hasAttribute(a,"className",b)?!0:!1),c},addClass:function(a,b){a&&b&&(SB.hasClass(a,b)||(a.className=SB.trim(a.className+" "+b)))},removeClass:function(a,b){SB.hasClass(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," "),a.className=SB.trim(a.className))},toggleClass:function(a,b){SB.hasClass(a,b)?SB.removeClass(a,b):SB.addClass(a,b)},setFocus:function(a){"function"==typeof a.setActive?a.setActive():"function"==typeof a.focus&&a.focus()},get:function(a){return document.getElementById(a)},getByTag:function(a,b){return b=b||document,b.getElementsByTagName(a)},getByClass:function(a,b,c){var d=[],e=[],f=0,g=0;if(b=b||document,c=c.toLowerCase()||"*","*"===c&&document.getElementsByClassName)return b.getElementsByClassName(a);if(b.getElementsByClassName)if(e=b.getElementsByClassName(a),c&&e.length)for(f in e)e[f].tagName&&e[f].tagName.toLowerCase()===c&&(d[g]=e[f],g+=1);else d=e;else{e=SB.getByTag(c,b);for(f in e)SB.hasClass(e[f],a)&&(d[g]=e[f],g+=1)}return d},getText:function(a){return a.textContent?a.textContent:a.innerText?a.innerText:a.text?a.text:a.innerHTML},putText:function(a,b){a.textContent?a.textContent=b:a.innerText?a.innerText=b:a.text?a.text=b:a.innerHTML=b},stripUnits:function(a){var b="";return b="string"==typeof a?parseInt(a.replace(new RegExp("(%|px|em)"),""),10):a},trim:function(a){return a=a||"",a.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replaceAll:function(a,b,c){var d=a;return"string"==typeof a&&(d=a.replace(new RegExp(b,"g"),c)),d},decode:function(a){var b="";return"object"==typeof JSON&&(b=JSON.parse(a)),b},encode:function(a){var b="";return"object"==typeof JSON&&(b=JSON.stringify(a)),b},log:function(a,b,c){var d=new Date,e="color: white";if("object"==typeof console&&"function"==typeof console.log)if(b&&"object"!=typeof a){switch(a="%c"+b+"%c: "+a+" ("+d.getHours()+":"+(d.getMinutes()<10?"0":"")+d.getMinutes()+")",c){case"success":e="color: green";break;case"info":e="color: aqua";break;case"error":e="color: red"}console.log(a,"background: black; "+e,"background: black; color: white")}else console.log(a)},vibrate:function(a){a=a||20,window.navigator&&window.navigator.vibrate?window.navigator.vibrate(a):SB.log("Not supported","Vibrate","error")},notify:function(a,b,c){var d,e;return"function"==typeof Notification&&("granted"===Notification.permission?(d=new Notification(a,b),setTimeout(function(){d.close(),SB.event.remove(d,"click",e)},1e4),e=function(a){window.focus(),c(a),SB.event.remove(d,"click",e)},SB.event.add(d,"click",e)):SB.notifyAsk()),d},notifyAsk:function(){"function"==typeof Notification&&"denied"!==Notification.permission&&Notification.requestPermission(function(a){Notification.permission!==a&&(Notification.permission=a)})},sound:{sounds:{},play:function(a){"function"==typeof Audio&&(SB.sound.sounds[a]||(SB.sound.sounds[a]=new Audio(a)),SB.sound.sounds[a].play())}},speak:function(a,b,c){var d,e;window.speechSynthesis?(d=new SpeechSynthesisUtterance,e=window.speechSynthesis.getVoices(),d.text=a,d.lang=b||"en-US",e&&e[10]&&"Alex"===e[10].name&&(d.voice=e[10],"female"===c&&(d.voice=e[30])),window.speechSynthesis.speak(d)):SB.log("Not supported","Speak","error")},transcribe:function(a){var b,c;return"webkitSpeechRecognition"in window?(SB.log("Supported","Transcribe","info"),b=new webkitSpeechRecognition,c=function(b){a(b.results[0][0].transcript,b.results[0][0].confidence),SB.event.remove(document,"result",c)},SB.event.add(b,"result",c)):SB.log("Not supported","Transcribe","error"),b},storage:function(a,b){var c;return a&&("undefined"!=typeof localStorage?(void 0!==b&&("object"==typeof b&&(b=SB.encode(b)),localStorage.setItem(a,b)),c=localStorage.getItem(a)):SB.log("Not supported","Local Storage","error")),c},ajax:{request:function(a){a.method=a.method||"GET",a.onStart=a.onStart||function(){},a.onComplete=a.onComplete||function(){};var b,c,d="?";if(c=function(){switch(a.onStart(),typeof a.onComplete){case"object":a.onComplete.value?a.onComplete.value=a.response:a.onComplete.childNodes[0]&&SB.putText(a.onComplete,a.response);break;case"function":a.onComplete()}},window.XMLHttpRequest)b=new XMLHttpRequest;else{if(!window.ActiveXObject)return!1;b=new ActiveXObject("Microsoft.XMLHTTP")}"GET"===a.method&&((-1!==a.path.indexOf("?")||-1!==a.param.indexOf("?"))&&(d="&"),a.path=a.path+d+a.param,a.param=""),b.open(a.method.toUpperCase(),a.path,!0),"POST"===a.method&&b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),b.setRequestHeader("rest","true"),SB.event.add(b,"readystatechange",function(){if(4===b.readyState){if(200!==b.status)return!1;a.response=b.responseText,c()}}),b.send(a.param)}},findMousePosition:function(a){var b;return b=a.touches&&a.touches.length?{positionX:a.touches[0].clientX,positionY:a.touches[0].clientY}:window.event?{positionX:window.event.clientX,positionY:window.event.clientY}:{positionX:a.clientX,positionY:a.clientY}},findStyle:function(a,b){var c="";if(a.currentStyle)b=b.replace(/-\w/g,function(a){return a.charAt(1).toUpperCase()}),c=a.currentStyle[b];else{if(!window.getComputedStyle)return 0;c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)}return c&&((-1!==c.indexOf("px")||-1!==c.indexOf("em")||-1!==c.indexOf("%"))&&(c=SB.stripUnits(c)),"opacity"===b&&(c=parseFloat(c,10))),c},findScroll:function(){var a=0;return"number"==typeof window.pageYOffset?a={positionX:window.pageXOffset,positionY:window.pageYOffset}:document.body&&document.body.scrollTop?a={positionX:document.body.scrollWidth,positionY:document.body.scrollTop}:document.documentElement&&document.documentElement.scrollTop&&(a={positionX:document.documentElement.scrollWidth,positionY:document.documentElement.scrollTop}),a},clickDrag:function(a){a.dragElm=a.dragElm||a.elm,a.restrict=a.restrict||!1,a.onStart=a.onStart||function(){},a.onTween=a.onTween||function(){},a.onComplete=a.onComplete||function(){};var b,c,d=void 0===document.body.ontouchstart?"mousedown":"touchstart",e=void 0===document.body.ontouchmove?"mousemove":"touchmove",f=void 0===document.body.ontouchend?"mouseup":"touchend",g=SB.findStyle(a.elm.parentNode,"border-left-width")+SB.findStyle(a.elm.parentNode,"border-right-width"),h=SB.findStyle(a.elm.parentNode,"border-top-width")+SB.findStyle(a.elm.parentNode,"border-bottom-width");b=function(b){if(SB.hasClass(a.elm,"active")){SB.cancelBubble(b),b.preventDefault&&b.preventDefault();var c,d,e=SB.findMousePosition(b),f=e.positionX,i=e.positionY,j=a.dragElm.offsetWidth,k=a.dragElm.offsetHeight;return a.newX=f-a.clickOffsetX+a.startOffsetX-(a.startWidth-SB.findScroll().positionX),a.newY=i-a.clickOffsetY+a.startOffsetY-(a.startHeight-SB.findScroll().positionY),a.restrict&&(c=a.elm.parentNode.offsetWidth-j-g,d=a.elm.parentNode.offsetHeight-k-h,a.newX>c&&(a.newX=c),a.newX<0&&(a.newX=0),a.newY>d&&(a.newY=d),a.newY<0&&(a.newY=0)),a.elm.style.margin=0,a.elm.style.left=a.newX+"px",a.elm.style.top=a.newY+"px",a.onTween(a),!1}},c=function(){SB.hasClass(a.elm,"active")&&(SB.removeClass(a.elm,"active"),SB.event.remove(document,"mousemove",b),SB.event.remove(document,"mouseup",c),a.onComplete(a))},SB.event.add(a.dragElm,d,function(d){var g=SB.findMousePosition(d);SB.clickDrag.zindex=SB.clickDrag.zindex||1,SB.cancelBubble(d),a.clickOffsetX=g.positionX,a.clickOffsetY=g.positionY,a.startOffsetX=a.elm.offsetLeft,a.startOffsetY=a.elm.offsetTop,a.startWidth=SB.findScroll().positionX,a.startHeight=SB.findScroll().positionY,a.elm.style.zIndex=SB.clickDrag.zindex+=1,a.elm.style.margin=0,a.elm.style.bottom="auto",a.elm.style.right="auto",a.elm.style.position="absolute",SB.addClass(a.elm,"active"),a.onStart(),d.preventDefault&&d.preventDefault(),SB.event.add(document,e,b),SB.event.add(document,f,c),b(d)})},init:function(){SB.spec&&SB.spec.init&&SB.spec.init(),SB.addClass(document.body,"rich")}}}(),document.addEventListener&&document.addEventListener("DOMContentLoaded",SB.init,!1),SB.event.add(window,"load",function(){"use strict";document.addEventListener||SB.init()}),SB.event.add(window,"unload",function(){"use strict";SB.event.removeAll()}),SB.spec=function(){"use strict";return{version:20151114,state:{},parsers:{},templates:{},strings:{},socket:{},uiComponents:{header:{},body:{},indicator:{},templates:[]},navChange:function(a){var b=SB.getByClass(a,SB.spec.uiComponents.header,"li")[0],c=SB.get(a),d=SB.getByClass("selected",SB.spec.uiComponents.header,"li")[0],e=SB.getByClass("selected",SB.spec.uiComponents.body,"section")[0];b&&!SB.hasClass(b,"selected")&&(SB.removeClass(d,"selected"),SB.removeClass(e,"selected"),SB.spec.lazyLoad(a),SB.storage("selected",a),SB.addClass(b,"selected"),SB.addClass(c,"selected"),SB.spec.sliderSetWidths(),SB.spec.lazyUnLoad(e))},updateTemplate:function(a){var b,c,d,e,f=SB.get(a.deviceId),g=SB.spec.parsers[a.typeClass],h=a.value,i=a.state,j=document.createElement("div");SB.spec.state[a.deviceId]=a,SB.log("Updated",a.deviceId,"success"),f&&(d=SB.spec.uiComponents.templates[a.typeClass].markup,c=SB.hasClass(f,"selected")?" selected":"",e=f.cloneNode(!0),b=SB.getByTag("h1",e)[0],b.parentNode.removeChild(b),e=e.innerHTML,g&&(d=g(a.deviceId,d,i,h,SB.spec.uiComponents.templates[a.typeClass].fragments)),"ok"===i?(d=d.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.ACTIVE),SB.hasClass(f,"device-off")&&(SB.removeClass(f,"device-off"),SB.addClass(f,"device-on"),SB.putText(SB.getByTag("em",SB.getByTag("h1",f)[0])[0],SB.spec.strings.ACTIVE))):(d=d.split("{{DEVICE_ACTIVE}}").join(SB.spec.strings.INACTIVE),SB.hasClass(f,"device-on")&&(SB.removeClass(f,"device-on"),SB.addClass(f,"device-off"),SB.putText(SB.getByTag("em",SB.getByTag("h1",f)[0])[0],SB.spec.strings.INACTIVE))),f&&d&&a&&(SB.storage("state",SB.spec.state),d=d.split("{{DEVICE_ID}}").join(a.deviceId),d=d.split("{{DEVICE_TYPE}}").join(a.typeClass),d=d.split("{{DEVICE_SELECTED}}").join(c),d="ok"===a.state?d.split("{{DEVICE_STATE}}").join(" device-on"):d.split("{{DEVICE_STATE}}").join(" device-off"),d=c?d.split("{{LAZY_LOAD_IMAGE}}").join("src"):d.split("{{LAZY_LOAD_IMAGE}}").join("data-src")),d&&(j.innerHTML=d,j=SB.getByTag("section",j)[0],b=SB.getByTag("h1",j)[0],b.parentNode.removeChild(b),j.innerHTML!==e&&(SB.getByClass("sliderBar",f,"div")[0]?(SB.event.removeAll(SB.getByClass("sliderBar",f,"div")[0].getElementsByTagName("span")[0]),f.outerHTML=d,SB.spec.buildSliders(a.deviceId)):f.outerHTML=d)))},buildIndicator:function(){var a;SB.get("indicator")||(a=document.createElement("span"),a.id="indicator",SB.addClass(a,"connecting"),SB.putText(a,SB.spec.strings.CONNECTING),SB.spec.uiComponents.indicator=a,SB.spec.uiComponents.header.appendChild(a))},checkConnection:function(){var a=SB.spec.socket.readyState<=1;return a||(SB.spec.socketConnect(0),a=SB.spec.socket.readyState<=1),a},socketConnect:function(a){var b,c,d,e,f,g,h="https:"===window.location.protocol?"wss":"ws";SB.spec.socket.readyState&&3!==SB.spec.socket.readyState||(SB.log("Connecting","WebSocket","info"),SB.spec.socket=new WebSocket(h+"://"+window.location.host,"echo-protocol"),a+=1,b=function(){var b=Math.round(Math.min(Math.max(a*(15*Math.random()),10),60));SB.log("Retrying in "+b+"s","WebSocket","info"),SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED),setTimeout(function(){SB.spec.socketConnect(a)},1e3*b)}),c=function(a){var b="disconnected"===SB.spec.uiComponents.indicator.className?!0:!1;SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),SB.log("Connected","WebSocket","success"),b&&(SB.spec.socket.send("fetch state"),SB.log("Reconnected","WebSocket","success")),SB.event.add(SB.spec.socket,"close",f)},d=function(a){var b,c,d=SB.decode(a.data),e={};if("string"==typeof d.speech)d.speech&&(SB.log(d.speech,"Speech","success"),SB.speak(d.speech,d.language,d.voice));else if("string"==typeof d.sound)SB.log(d.sound,"Sound","success"),SB.sound.play("/mp3/"+d.sound+".mp3");else if("string"==typeof d.title)c=function(){d.deviceId&&SB.spec.navChange(d.deviceId)},b=SB.notify(d.title,d.options,c);else if("string"==typeof d.deviceId)SB.spec.updateTemplate(d);else if("object"==typeof d){for(e in d)break;if(d[e]&&d[e].deviceId){SB.log("Received","State","success");for(e in d)SB.spec.updateTemplate(d[e])}else d[e]&&d[e].markup&&(SB.spec.uiComponents.templates=d,SB.storage("templates",SB.spec.uiComponents.templates))}},f=function(a){SB.event.remove(SB.spec.socket,"close",f),SB.log("Disconnected","WebSocket","error"),b()},e=function(a){SB.event.remove(SB.spec.socket,"error",f),SB.log("Error","WebSocket","error"),b()},g=function(){SB.event.remove(SB.spec.socket,"open",c),SB.event.remove(SB.spec.socket,"message",d),SB.event.remove(SB.spec.socket,"error",e),SB.event.remove(SB.spec.socket,"close",g)},SB.event.add(SB.spec.socket,"open",c),SB.event.add(SB.spec.socket,"message",d),SB.event.add(SB.spec.socket,"error",e),SB.event.add(SB.spec.socket,"close",g)},statePoller:function(){var a;SB.log("not supported - using polling","WebSockets","error"),a={path:"/templates/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){SB.spec.uiComponents.templates=SB.decode(a.response),SB.storage("templates",SB.spec.uiComponents.templates)}},SB.ajax.request(a),setInterval(function(){var a={path:"/state/",param:"ts="+(new Date).getTime(),method:"GET",onComplete:function(){var b,c=SB.decode(a.response);if(c){SB.spec.uiComponents.indicator.className="connected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTED),setTimeout(function(){SB.spec.uiComponents.indicator.className="connecting",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.CONNECTIG)},1e3);for(b in c)SB.spec.updateTemplate(c[b])}else SB.spec.uiComponents.indicator.className="disconnected",SB.putText(SB.spec.uiComponents.indicator,SB.spec.strings.DISCONNECTED)}};SB.ajax.request(a)},1e4)},lazyLoad:function(a){var b,c,d=0;if(SB.get(a))for(b=SB.get(a),c=SB.getByTag("img",b),d=0;d<c.length;d+=1)c[d].getAttribute("data-src")&&!c[d].src&&(c[d].src=c[d].getAttribute("data-src"))},lazyUnLoad:function(a){var b,c=0;if(a)for(b=SB.getByTag("img",a),c=0;c<b.length;c+=1)b[c].getAttribute("src")&&SB.hasClass(b[c],"streaming")&&(b[c].setAttribute("data-src",b[c].src),b[c].removeAttribute("src"))},findTextInputs:function(){return SB.spec.uiComponents.body.getElementsByTagName("input")},findNumberInputs:function(){var a,b=SB.spec.findTextInputs(),c=[];for(a=0;a<b.length;a+=1)"number"===b[a].type&&c.push(b[a]);return c},findSliderPosition:function(a,b){var c,d,e,f,g=0;return b&&(c=a.parentNode.offsetWidth-a.offsetWidth,d=parseInt(b.min,10),e=parseInt(b.max,10),f=parseInt(b.value,10),g=(f-d)*c/(e-d),g=c>g?g:c,g=g>0?g:0),Math.round(g)},findSliderValue:function(a,b){var c=a.parentNode.previousSibling,d=a.parentNode.offsetWidth-a.offsetWidth,e=parseInt(c.min,10),f=parseInt(c.max,10),g=b.newX,h=(f-e)/d*g+e;return Math.round(h)},buildSliders:function(a){var b,c,d,e=SB.spec.findNumberInputs();for(b=function(a,b){a.style.left=SB.spec.findSliderPosition(a,b)+"px",SB.clickDrag({elm:a,restrict:!0,onTween:function(c){var d=SB.spec.findSliderValue(a,c);b.value=d,a.setAttribute("aria-valuenow",d)},onComplete:function(a){c(b)}})},c=function(a){var b,c=a.parentNode;if(SB.hasClass(a.nextSibling,"sliderBar")){for(b=a.nextSibling.getElementsByTagName("span")[0],b.style.left=SB.spec.findSliderPosition(b,a)+"px";c!==document&&"form"!==c.tagName.toLowerCase();)c=c.parentNode;"form"===c.tagName.toLowerCase()&&SB.spec.sendInput(c)}},d=0;d<e.length;d+=1)!function(c){var d,e;"number"===c.type&&c.min&&c.max&&(!a||SB.isChildOf(c,SB.get(a)))&&(d=document.createElement("div"),d.className="sliderBar",e=document.createElement("span"),e.setAttribute("role","slider"),e.setAttribute("tabindex",0),e.setAttribute("aria-valuenow",c.value),e.setAttribute("aria-valuemin",c.min),e.setAttribute("aria-valuemax",c.max),d.appendChild(e),c.parentNode.insertBefore(d,c.nextSibling),a?b(e,c):SB.event.add(window,"load",function(){b(e,c)}))}(e[d]);a||(SB.event.add(SB.spec.uiComponents.body,"keydown",function(a){var b,c=SB.getTarget(a),d=null;SB.hasClass(c.parentNode,"sliderBar")&&(b=c.parentNode.previousSibling,38===a.keyCode||39===a.keyCode?(d=parseInt(b.value,10)+1,d=d<=b.max?d:b.max):(37===a.keyCode||40===a.keyCode)&&(d=parseInt(b.value,10)-1,d=d>=b.min?d:b.min),d&&d>=b.min&&d<=b.max&&(a.preventDefault(),b.value=d))}),SB.event.add(SB.spec.uiComponents.body,"keyup",function(a){var b=SB.getTarget(a);SB.hasClass(b.parentNode,"sliderBar")&&c(b.parentNode.previousSibling)}),SB.event.add(window,"resize",function(a){SB.spec.sliderSetWidths(e)}),SB.event.add(SB.spec.uiComponents.body,"change",function(a){c(SB.getTarget(a))}))},sliderSetWidths:function(){var a,b,c=SB.spec.findNumberInputs();for(b=0;b<c.length;b+=1)SB.hasClass(c[b].nextSibling,"sliderBar")&&(a=c[b].nextSibling.getElementsByTagName("span")[0],a.style.left=SB.spec.findSliderPosition(a,c[b])+"px")},command:function(){var a=null,b=0,c=750,d=!1,e=!1,f=!1,g=!1,h=0,i=0,j=5,k=null,l=450,m=function(b){var c=a;SB.vibrate(),SB.spec.sendTextInput(b,c,"text"),p()},n=function(a){var b=SB.getTarget(a),c=b.tagName.toLowerCase(),d=null;return b="img"===c?b.parentNode:b,b="i"===c?b.parentNode:b,b="span"===c?b.parentNode:b,"a"===b.tagName.toLowerCase()&&(d=b),d},o=function(b,c){var d=n(b);c?(SB.vibrate(),a=SB.getTarget(b).parentNode.parentNode.id,k=SB.transcribe(m),k.start()):d&&!f&&("external"===d.rel?window.open(d.href,"_blank").focus():(a=d.href,q()))},p=function(d){a=null,c=750,b=0,f=!0,e=!1,g=!1,h=0,i=0},q=function(){var d,e=(new Date).getTime();a&&!f&&(SB.vibrate(),SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Command","success"),SB.spec.socket.send(a)):(d={path:a,param:"ts="+e,method:"GET",onComplete:function(){SB.log(d.response)}},SB.ajax.request(d)),b>3&&(c=650),b>10&&(c=500),b+=1,setTimeout(q,c))};"ontouchstart"in document.documentElement&&(SB.log("Enabled","Touch Events","info"),SB.event.add(SB.spec.uiComponents.body,"touchstart",function(a){d=!0,e=!0,n(a)&&(f=!1,h=parseInt(a.changedTouches[0].clientX,10),i=parseInt(a.changedTouches[0].clientY,10),setTimeout(function(){g||(d=!1,o(a))},l))}),SB.event.add(SB.spec.uiComponents.body,"contextmenu",function(a){a.preventDefault()}),SB.event.add(SB.spec.uiComponents.body,"touchend",function(a){!SB.hasClass(SB.getTarget(a).parentNode,"emoji")&&d&&(g=!0,o(a)),p(a)}),SB.event.add(SB.spec.uiComponents.body,"touchmove",function(a){e&&(Math.abs(parseInt(a.changedTouches[0].clientX,10)-h)>j||Math.abs(parseInt(a.changedTouches[0].clientY,10)-i)>j)&&p(a)}),SB.event.add(SB.spec.uiComponents.body,"touchcancel",function(a){p(a)})),SB.event.add(SB.spec.uiComponents.body,"mousedown",function(a){SB.hasClass(SB.getTarget(a).parentNode,"emoji")?o(a,!0):e===!1&&d===!1&&(f=!1,o(a)),d=!1}),SB.event.add(SB.spec.uiComponents.body,"mouseup",function(a){SB.hasClass(SB.getTarget(a).parentNode,"emoji")||p(a)}),SB.event.add(SB.spec.uiComponents.body,"click",function(a){n(a)&&a.preventDefault()})},sendInput:function(a){var b=SB.getByTag("input",a,"input")[0],c=b.value,d=b.name,e=SB.getByClass("input-type",a,"input")[0].value;"text"===b.type&&(b.value=""),SB.spec.sendTextInput(c,d,e)},sendTextInput:function(a,b,c){var d,e=(new Date).getTime();c=c||"text",SB.spec.socket?SB.spec.checkConnection()&&(SB.log("Issued","Text Command","success"),SB.spec.socket.send("/?"+b+"="+c+"-"+a)):(d={path:"/",param:b+"="+c+"-"+a+"&ts="+e,method:"POST",onComplete:function(){SB.log(d.response)}},SB.ajax.request(d))},formInput:function(){SB.event.add(SB.spec.uiComponents.body,"submit",function(a){var b=SB.getTarget(a);a.preventDefault(),SB.spec.sendInput(b)})},nav:function(){SB.event.add(SB.spec.uiComponents.header,"click",function(a){var b=SB.getTarget(a).parentNode,c=b.tagName.toLowerCase();"li"===c?(a.preventDefault(),SB.spec.navChange(b.className),SB.vibrate(),SB.notifyAsk()):"indicator"===SB.getTarget(a).id&&SB.hasClass(SB.getTarget(a),"disconnected")&&SB.spec.socketConnect(0)})},init:function(){var a,b,c,d=SB.storage("selected"),e=SB.storage("templates"),f=SB.storage("state");if(SB.spec.uiComponents.header=SB.getByTag("header")[0],SB.spec.uiComponents.body=SB.getByTag("main")[0],SB.spec.buildIndicator(),b=SB.spec.uiComponents.header.dataset,c=SB.spec.uiComponents.body.dataset,SB.spec.strings={CONNECTED:b.stringConnected,CONNECTING:b.stringConnecting,DISCONNECTED:b.stringDisconnected,ACTIVE:c.stringActive,INACTIVE:c.stringInactive,ON:c.stringOn,OFF:c.stringOff,AM:c.stringAm,PM:c.stringPm,SUN:c.stringSun,MON:c.stringMon,TUE:c.stringTue,WED:c.stringWed,THUR:c.stringThur,FRI:c.stringFri,SAT:c.stringSat},d&&SB.spec.navChange(d),e&&f){SB.spec.uiComponents.templates=SB.decode(e),f=SB.decode(f);for(a in f)SB.spec.updateTemplate(f[a])}"function"==typeof WebSocket||"object"==typeof WebSocket?SB.spec.socketConnect(0):SB.spec.statePoller(),SB.spec.lazyLoad(document.body.className),SB.spec.buildSliders(),SB.spec.command(),SB.spec.formInput(),SB.spec.nav()}}}(),function(a){"use strict";a.activeBuilding=function(a,b,c,d,e){var f="",g="",h="",i="",j=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"activeBuilding"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"activeBuilding",e)),a},k=function(a){var b,c="";return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.arrayList(a,"activeBuilding",e):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.arrayList(a,"activeBuilding",e)),c};return c&&d&&(i=k(d)),d&&0!==d.length?1===d.length?(g="ok",h="tag",f=j("SINGLE_PACKAGE")):d.length>1&&(g="ok",h="tags",f=j("PLURAL_PACKAGES")):(g="err",h="times",f=j("NO_PACKAGES")),f=f.split("{{SENDERS}}").join(i),b=b.replace("{{ACTIVEBUILDING_STATE}}",g),b=b.replace("{{ACTIVEBUILDING_ICON}}",h),b=b.replace("{{ACTIVEBUILDING_DYNAMIC}}",f)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.debug=function(a,b,c,d,e,f){var g=(new Date).getTime(),h="",i="",j=0,k=0,l=0,m=0,n=0,o=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"debug"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"debug",f)),a},p=function(a){var b,c;return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.displayTime(a,o):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.displayTime(a,o)),c},q=function(a){var b,c;return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.displayRelativeTime(a):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.displayRelativeTime(a)),c};return d&&(h=q(d.uptime),i=q((g-d.startup)/1e3),j=d.memoryUsed,k=d.totalMemory,l=d.percentMemory,m=Math.round(100*d.cpuLoad[0]),n=d.clientCount),b=b.replace("{{DEBUG_UPDATE}}",p(g)),b=b.replace("{{DEBUG_UPTIME}}",h),b=b.replace("{{DEBUG_RUNTIME}}",i),b=b.replace("{{DEBUG_MEMORY_USED}}",j),b=b.replace("{{DEBUG_SYSTEM_MEMORY}}",k),b=b.replace("{{DEBUG_MEMORY_PERCENT}}",l),b=b.replace("{{DEBUG_CPU}}",m),b=b.replace("{{DEBUG_CLIENT_COUNT}}",n)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.denon=function(a,b,c,d,e){return d&&(b=b.split("{{DEVICE_POWER}}").join(d.power),d.ZONE1&&(b=b.split("{{DEVICE_Z1_INPUT}}").join(d.ZONE1.input),b=b.split("{{DEVICE_Z1_POWER}}").join(d.ZONE1.power),b=b.split("{{DEVICE_Z1_MUTE}}").join(d.ZONE1.mute),b=b.split("{{DEVICE_Z1_MODE}}").join(d.ZONE1.mode),b=b.split("{{DEVICE_Z1_VOLUME}}").join(d.ZONE1.volume),b=b.split("{{DEVICE_Z1_MAXVOLUME}}").join(d.ZONE1.maxvolume)),d.ZONE2&&(b=b.split("{{DEVICE_Z2_POWER}}").join(d.ZONE2.power),b=b.split("{{DEVICE_Z2_INPUT}}").join(d.ZONE2.input),b=b.split("{{DEVICE_Z2_VOLUME}}").join(d.ZONE2.volume)),d.ZONE3&&(b=b.split("{{DEVICE_Z3_POWER}}").join(d.ZONE3.power),b=b.split("{{DEVICE_Z3_INPUT}}").join(d.ZONE3.input),b=b.split("{{DEVICE_Z3_VOLUME}}").join(d.ZONE3.volume))),b=b.split("{{DEVICE_POWER}}").join(""),b=b.split("{{DEVICE_Z1_POWER}}").join(""),b=b.split("{{DEVICE_Z1_INPUT}}").join(""),b=b.split("{{DEVICE_Z1_MUTE}}").join(""),b=b.split("{{DEVICE_Z1_MODE}}").join(""),b=b.split("{{DEVICE_Z1_VOLUME}}").join(""),b=b.split("{{DEVICE_Z1_MAXVOLUME}}").join(""),b=b.split("{{DEVICE_Z2_POWER}}").join(""),b=b.split("{{DEVICE_Z2_INPUT}}").join(""),b=b.split("{{DEVICE_Z2_VOLUME}}").join(""),b=b.split("{{DEVICE_Z3_POWER}}").join(""),b=b.split("{{DEVICE_Z3_INPUT}}").join(""),b=b.split("{{DEVICE_Z3_VOLUME}}").join("")}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.foscam=function(a,b,c,d,e){var f,g,h="",i="",j="",k=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"foscam"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"foscam",e)),a};return"on"===d?(h=" device-active",j=k("CAMERA_ARMED")):"off"===d&&(i=" device-active",j=k("CAMERA_DISARMED")),b=b.split("{{DEVICE_STATE_ON}}").join(h),b=b.split("{{DEVICE_STATE_OFF}}").join(i),b=b.split("{{ARMED_STATUS}}").join(j),b=b.split("{{DISARMED_STATUS}}").join(j),"object"==typeof SB&&(f=SB.getByClass("fa-lock",SB.get(a),"a")[0],g=SB.getByClass("fa-unlock",SB.get(a),"a")[0],"on"!==d||SB.hasClass(f,"device-on")?"off"!==d||SB.hasClass(g,"device-on")?b=SB.hasClass(SB.getByClass("selected",null,"li")[0],a)?b.split("{{LAZY_LOAD_IMAGE}}").join("src"):b.split("{{LAZY_LOAD_IMAGE}}").join("data-src"):(SB.addClass(g,"device-active"),SB.removeClass(f,"device-active"),SB.putText(SB.getByTag("em",f)[0],j),SB.putText(SB.getByTag("em",g)[0],j),b=""):(SB.addClass(f,"device-active"),SB.removeClass(g,"device-active"),SB.putText(SB.getByTag("em",f)[0],j),SB.putText(SB.getByTag("em",g)[0],j),b="")),b}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.gerty=function(a,b,c,d,e,f){var g,h,i,j,k=e.comment,l="",m="",n=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"gerty"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"gerty",f)),a},o=function(a){var b,c;return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.displayTime(a,n):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.displayTime(a,n)),c};if(d.comments)for(h in d.comments)g=o(d.comments[h].time),m+=k.split("{{TIME}}").join(g),m=m.split("{{CODE}}").join(d.comments[h].code),m=m.split("{{NAME}}").join(d.comments[h].name),m=m.split("{{COMMENT}}").join(d.comments[h].text);return"object"==typeof SB?(i=SB.getByTag("span",SB.get(a))[0],j=SB.getByTag("ol",SB.get(a))[0],i&&i.innerHTML!==d.emoji&&(SB.putText(i,d.emoji),i.className=d.action||""),j&&j.innerHTML!==m&&(j.innerHTML=m,j.scrollTop=j.scrollHeight),b=""):(d.action&&(l=' class="'+d.action+'"'),b=b.split("{{GERTY_ACTION}}").join(l),b=b.split("{{GERTY_DYNAMIC}}").join(d.emoji),b=b.split("{{GERTY_COMMENTS}}").join(m)),b}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.github=function(a,b,c,d,e,f){var g=e.commit,h=e.message,i="",j="",k=0,l=null,m=null,n="",o=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"github"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"github",f)),a},p=function(a){var b,c;return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.displayTime(a,o,"long"):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.displayTime(a,o,"long")),c};if(c&&d)for(k;k<d.length;k+=1)j=p(d[k].time),i+=g.split("{{GITHUB_URL}}").join(d[k].url),i=i.split("{{GITHUB_TITLE}}").join(j),i=i.split("{{GITHUB_DESCRIPTION}}").join(d[k].description),d[k].upToDate===!1?m="NEWER":d[k].upToDate===!0&&(l="LATEST");return b=b.replace("{{GITHUB_DYNAMIC}}",i),m?n=o(m):l&&(n=o(l)),i=h.replace("{{GITHUB_MESSAGE}}",n),b=b.replace("{{GITHUB_MESSAGE}}",i)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.location=function(a,b,c,d,e,f){var g=e.item,h="",i="",j=0,k=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"location"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"location",f)),a},l=function(a){var b,c;return"object"==typeof SB&&"object"==typeof SB.util?c=SB.util.displayTime(a,k):(b=require(__dirname+"/../../lib/sharedUtil").util,c=b.displayTime(a,k)),c};if(c&&d)for(j;j<d.length;j+=1)i=l(d[j].time),h+=g.split("{{LOCATION_NAME}}").join(d[j].name),h=h.split("{{LOCATION_URL}}").join(d[j].url),h=h.split("{{LOCATION_TIME}}").join(i),h=h.split("{{LOCATION_ALTITUDE}}").join(d[j].alt),h=h.split("{{LOCATION_SPEED}}").join(Math.ceil(d[j].speed));return b=b.replace("{{LOCATION_DYNAMIC}}",h)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.nest=function(a,b,c,d,e,f){var g,h,i,j,k=e.thermostat,l=e.protect,m=e.group,n="",o="",p="",q={},r=function(a){var b;return"object"==typeof SB?a=SB.util.encodeName(a):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.encodeName(a)),"group-"+a},s=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"nest"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"nest",f)),a};if(d){for(g in d.devices)if(q=d.devices[g],"thermostat"===q.type){switch("object"==typeof SB&&(SB.getByClass(r(q.label),SB.get(a),"li")[0]?(j=SB.getByClass(r(q.label),SB.get(a),"li")[0],h=SB.getByClass("fa-sun-o",j,"a")[0],i=SB.getByClass("fa-asterisk",j,"a")[0],"cool"!==q.state||SB.hasClass(i,"device-active")?"heat"!==q.state||SB.hasClass(h,"device-active")?"off"!==q.state||SB.hasClass(j,"device-off")||(SB.addClass(j,"device-off"),SB.removeClass(i,"device-active"),SB.removeClass(h,"device-active"),SB.putText(SB.getByTag("em",j)[0],s("OFF")),b=""):(SB.addClass(h,"device-active"),SB.removeClass(i,"device-active"),SB.removeClass(j,"device-off"),SB.putText(SB.getByTag("em",j)[0],s("HEAT")),b=""):(SB.addClass(i,"device-active"),SB.removeClass(h,"device-active"),SB.removeClass(j,"device-off"),SB.putText(SB.getByTag("em",j)[0],s("COOL")),b="")):SB.spec.buildSliders(a)),n+=k.split("{{SUB_DEVICE_ID}}").join(r(q.label)),n=n.split("{{SUB_DEVICE_NAME}}").join(q.label),n=n.split("{{SUB_DEVICE_TEMP}}").join(Math.round(q.temp)),n=n.split("{{SUB_DEVICE_TARGET}}").join(Math.round(q.target)),n=n.split("{{SUB_DEVICE_HUMIDITY}}").join(Math.round(q.humidity)),q.state){case"cool":n=n.split("{{DEVICE_STATE_COOL}}").join(" device-active"),n=n.split("{{SUB_DEVICE_STATUS}}").join(s("COOL"));break;case"heat":n=n.split("{{DEVICE_STATE_HEAT}}").join(" device-active"),n=n.split("{{SUB_DEVICE_STATUS}}").join(s("HEAT"));break;default:n=n.split("{{DEVICE_STATE_OFF}}").join(" device-off"),n=n.split("{{SUB_DEVICE_STATUS}}").join(s("OFF"))}q.leaf===!0&&(n=n.split("{{DEVICE_STATE_LEAF}}").join(" device-active")),n=d.presence&&"on"===d.presence?n.split("{{DEVICE_STATE_HOME}}").join(" device-active"):n.split("{{DEVICE_STATE_AWAY}}").join(" device-active"),n=n.split("{{DEVICE_STATE_COOL}}").join(""),
n=n.split("{{DEVICE_STATE_HEAT}}").join(""),n=n.split("{{DEVICE_STATE_OFF}}").join(""),n=n.split("{{DEVICE_STATE_LEAF}}").join(""),n=n.split("{{DEVICE_STATE_HOME}}").join(""),n=n.split("{{DEVICE_STATE_AWAY}}").join("")}else"protect"===q.type&&(p="","ok"!==q.smoke&&(p+="smoke "),"ok"!==q.co&&(p+="co "),"ok"!==q.battery&&(p+="batt "),p&&(p+="device-active"),o+=l.split("{{SUB_DEVICE_STATE}}").join(p),o=o.split("{{SUB_DEVICE_NAME}}").join(q.label),o=o.split("{{SUB_DEVICE_SMOKE}}").join(q.smoke),o=o.split("{{SUB_DEVICE_CO}}").join(q.co),o=o.split("{{SUB_DEVICE_BATT}}").join(q.battery));n&&(n=m.replace("{{SUB_DEVICE_LIST}}",n),n=n.replace("{{SUB_DEVICE_CLASS}}"," control-device-status"),n=n.replace("{{SUB_DEVICE_NAME}}",s("THERMOSTAT"))),o&&(o=m.replace("{{SUB_DEVICE_LIST}}",o),o=o.replace("{{SUB_DEVICE_CLASS}}"," text-device-status"),o=o.replace("{{SUB_DEVICE_NAME}}",s("PROTECT")))}return b=b.replace("{{NEST_DYNAMIC}}",n+o)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.raspberryRemote=function(a,b,c,d,e,f){var g,h=e["switch"],i=0,j="",k=function(a){var b=h,c="";return c=b.split("{{SUB_DEVICE_ID}}").join(a.label.split(" ").join("+")),c=c.split("{{SUB_DEVICE_NAME}}").join(a.label)};if(d&&"object"==typeof d&&(g=d.devices))for(i in g)j+=k(g[i]),j=j.split("{{SUB_DEVICE_CLASS}}").join(g[i].className||"fa-lightbulb-o");return b.replace("{{RASPBERRY_REMOTE_DYNAMIC}}",j)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.roku=function(a,b,c,d,e){var f=e.list,g=0,h="";if(d)for(g in d)h+=f.split("{{APP_ID}}").join(d[g].id),h=h.split("{{APP_IMG}}").join(d[g].cache),h=h.split("{{APP_NAME}}").join(d[g].name);return b.replace("{{ROKU_DYNAMIC}}",h)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.rss=function(a,b,c,d,e){var f=e.item,g="",h=0;if(c&&d)for(h;h<d.length;h+=1)g+=f.split("{{RSS_URL}}").join(d[h].url),g=g.split("{{RSS_TITLE}}").join(d[h].title),g=g.split("{{RSS_DESCRIPTION}}").join(d[h].description);return b=b.replace("{{RSS_DYNAMIC}}",g)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.smartthings=function(a,b,c,d,e,f){var g,h,i=e.action,j=e["static"],k=e.group,l=0,m=0,n="",o="",p="",q=function(a){var b;return"object"==typeof SB?a=SB.util.encodeName(a):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.encodeName(a)),"group-"+a},r=function(a,b){var c={},d=[],e=0,f=0;for(e in b)c=b[e],c.label===a&&(d[f]=c,f+=1);return d},s=function(a,b){var c="",d="",e="",f="",g="";switch(a.type){case"switch":c=i,e="fa-lightbulb-o";break;case"lock":c=i,e="fa-unlock-alt";break;case"contact":c=j,e="fa-columns";break;case"water":c=j,e="fa-tint";break;case"motion":c=j,e="fa-paw";break;case"presence":c=j,e="fa-male"}return a.peripheral&&a.peripheral.temp&&(f=" ("+a.peripheral.temp+"&deg;)"),a.peripheral&&"on"===a.peripheral.vibrate&&(g=" device-vibrate"),c&&(d=c.split("{{SUB_DEVICE_ID}}").join(a.label.split(" ").join("+")),d=d.split("{{SUB_DEVICE_NAME}}").join(a.label+f),d=d.split("{{SUB_DEVICE_CLASS}}").join(a.className||e),"on"===a.state?(d=d.split("{{SUB_DEVICE_STATE}}").join(" device-active"+g),d=d.split("{{SUB_DEVICE_STATUS}}").join(t("ACTIVE"))):(d=d.split("{{SUB_DEVICE_STATE}}").join(g),d=d.split("{{SUB_DEVICE_STATUS}}").join(t("INACTIVE")))),d},t=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"smartthings"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"smartthings",f)),a};if(d&&"object"==typeof d&&"string"==typeof d.mode){if(o=d.mode,g=d.devices)if(d.groups)for(l in d.groups){n+=k,p="";for(m in d.groups[l])h=r(d.groups[l][m],g),h&&h[0]&&(p+=s(h[0]));n=n.split("{{GROUP_CLASS}}").join(q(l)),n=n.split("{{GROUP_TITLE}}").join(l),n=n.split("{{SUB_DEVICE_LIST}}").join(p)}else for(l in g)n+=s(g[l]);switch(o){case"Home":b=b.split("{{DEVICE_STATE_HOME}}").join(" device-active"),b=b.split("{{HOME_STATUS}}").join(t("ACTIVE"));break;case"Away":b=b.split("{{DEVICE_STATE_AWAY}}").join(" device-active"),b=b.split("{{AWAY_STATUS}}").join(t("ACTIVE"));break;case"Night":b=b.split("{{DEVICE_STATE_NIGHT}}").join(" device-active"),b=b.split("{{NIGHT_STATUS}}").join(t("ACTIVE"))}}return b=b.split("{{DEVICE_STATE_HOME}}").join(""),b=b.split("{{DEVICE_STATE_AWAY}}").join(""),b=b.split("{{DEVICE_STATE_NIGHT}}").join(""),b=b.split("{{HOME_STATUS}}").join(t("INACTIVE")),b=b.split("{{AWAY_STATUS}}").join(t("INACTIVE")),b=b.split("{{NIGHT_STATUS}}").join(t("INACTIVE")),b.replace("{{SMARTTHINGS_DYNAMIC}}",n)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.stocks=function(a,b,c,d,e,f){var g=e.list,h=0,i="",j="",k="",l="",m=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"stocks"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"stocks",f)),a};if(d)for(h in d)0===d[h].dayChangeValue.indexOf("+")?(j="gain",k="arrow-up",l=m("GAIN")):0===d[h].dayChangeValue.indexOf("-")?(j="loss",k="arrow-down",l=m("LOSS")):(j="neutral",k="arrows-h",l=m("NEUTRAL")),i+=g.split("{{STOCK_CHANGE}}").join(j),i=i.split("{{STOCK_ARROW}}").join(k),i=i.split("{{STOCK_DIRECTION}}").join(l),i=i.split("{{STOCK_NAME}}").join(d[h].name),i=i.split("{{STOCK_PRICE}}").join(d[h].price),i=i.split("{{STOCK_CHANGE_VALUE}}").join(d[h].dayChangeValue),i=i.split("{{STOCK_CHANGE_PERCENT}}").join(d[h].dayChangePercent);return b.replace("{{STOCKS_DYNAMIC}}",i)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.traffic=function(a,b,c,d,e){var f=e.list,g=0,h="";if(d)for(g in d)h+=f.split("{{CAM_IMG}}").join(d[g].image),h=h.split("{{CAM_NAME}}").join(d[g].title);return b.replace("{{TRAFFIC_DYNAMIC}}",h)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.travis=function(a,b,c,d,e){var f=e.build,g="",h="",i="",j=0;if(c&&d)for(j;j<d.length;j+=1)h="",i="","created"===d[j].state||"started"===d[j].state?h="cogs":"ok"===d[j].status?h="check":"err"===d[j].status&&(h="times"),d[j].duration&&(i=" ("+d[j].duration+"s)"),g+=f.split("{{TRAVIS_URL}}").join(d[j].url),g=g.split("{{TRAVIS_ICON}}").join(h),g=g.split("{{TRAVIS_STATE}}").join(d[j].status),g=g.split("{{TRAVIS_DURATION}}").join(i),g=g.split("{{TRAVIS_DESCRIPTION}}").join(d[j].label);return b=b.replace("{{TRAVIS_DYNAMIC}}",g)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.twitter=function(a,b,c,d,e){var f=e.tweet,g="",h=0;if(c&&d)for(h;h<d.length;h+=1)g+=f.split("{{TWEET_TEXT}}").join(d[h].text),g=g.split("{{TWEET_URL}}").join(d[h].url),g=g.split("{{TWEET_AUTHOR}}").join(d[h].author);return b=b.replace("{{TWITTER_DYNAMIC}}",g)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.weather=function(a,b,c,d,e,f){var g,h,i=e.forecast,j=0,k="";if(g=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"weather"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"weather",f)),a},h=function(a){var b="";return a=parseInt(a,10),b=2>=a?"warning":4>=a?"bolt":8>=a?"asterisk":12>=a?"tint":18>=a?"asterisk":22>=a?"fire":24>=a?"flag":25===a||35===a?"asterisk":30>=a?"cloud":31===a||33===a?"moon-o":32===a||34===a||36===a?"sun-o":39>=a?"bolt":40===a?"tint":43>=a?"asterisk":44===a?"cloud":45===a?"bolt":46===a?"asterisk":47===a?"bolt":"question"},d&&d.code){b=b.replace("{{WEATHER_ICON}}",h(d.code)),b=b.replace("{{WEATHER_CURRENT}}",d.city+" "+g("CURRENT")+": "+d.temp+"&deg; "+d.text),b=b.replace("{{WEATHER_SUNRISE}}",d.sunrise),b=b.replace("{{WEATHER_SUNSET}}",d.sunset);for(j in d.forecast)k+=i.split("{{WEATHER_ICON}}").join(h(d.forecast[j].code)),k=k.split("{{WEATHER_DAY}}").join(d.forecast[j].day+":"),k=k.split("{{WEATHER_TEXT}}").join(d.forecast[j].text),k=k.split("{{WEATHER_HIGH}}").join(d.forecast[j].high+"&deg;"),k=k.split("{{WEATHER_LOW}}").join(d.forecast[j].low+"&deg;")}else b=b.replace("{{WEATHER_CURRENT}}",g("UNAVAILABLE")),"string"==typeof d&&(k=d);return b.replace("{{WEATHER_DYNAMIC}}",k)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.wemo=function(a,b,c,d,e,f){var g,h=e["switch"],i=e.group,j=0,k=0,l="",m="",n="",o=function(a){var b;return"object"==typeof SB?a=SB.util.encodeName(a):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.encodeName(a)),a},p=function(a,b){var c={},d=0;for(d in b)if(b[d].label===a){c=b[d];break}return c},q=function(a,b){var c="";return m&&(m+="device-active"),c=h.split("{{SUB_DEVICE_ID}}").join(a.label.split(" ").join("+")),c=c.split("{{SUB_DEVICE_NAME}}").join(a.label),c=c.split("{{SUB_DEVICE_CLASS}}").join(a.className||"fa-lightbulb-o"),"on"===a.state?(c=c.split("{{SUB_DEVICE_STATE}}").join(" device-active"),c=c.split("{{SUB_DEVICE_STATUS}}").join(r("ACTIVE"))):"off"===a.state?(c=c.split("{{SUB_DEVICE_STATE}}").join(""),c=c.split("{{SUB_DEVICE_STATUS}}").join(r("INACTIVE"))):(c=c.split("{{SUB_DEVICE_STATE}}").join(" device-off"),c=c.split("{{SUB_DEVICE_STATUS}}").join(r("INACTIVE"))),c},r=function(a){var b;return"object"==typeof SB&&"object"==typeof SB.util?a=SB.util.translate(a,"wemo"):(b=require(__dirname+"/../../lib/sharedUtil").util,a=b.translate(a,"wemo",f)),a};if(d&&d.devices){if(d.groups)for(j in d.groups){l+=i,n="";for(k in d.groups[j])g=p(d.groups[j][k],d.devices),g&&(n+=q(g));l=l.split("{{GROUP_CLASS}}").join(o(j)),l=l.split("{{GROUP_TITLE}}").join(j),l=l.split("{{SUB_DEVICE_LIST}}").join(n)}else for(j in d.devices)l+=q(d.devices[j]);l&&(l=l.replace("{{SUB_DEVICE_CLASS}}"," text-device-status"))}return b.replace("{{WEMO_DYNAMIC}}",l)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.xbmc=function(a,b,c,d,e){var f=(e.current,"");return d&&d.current&&(f=e.current.split("{{DEVICE_CURRENT}}").join(d.current)),b.replace("{{XBMC_DYNAMIC}}",f)}}("undefined"==typeof exports?this.SB.spec.parsers:exports),function(a){"use strict";a.util={version:20151215,replaceAll:function(a,b,c){var d=a;return"string"==typeof a&&(d=a.replace(new RegExp(b,"g"),c)),d},stripTags:function(a){return"string"==typeof a?a.replace(/(<([^>]+)>)/gi,""):a},stripControl:function(a){return"string"==typeof a?a.replace(new RegExp("[\x00-]+","g"),""):a},sanitize:function(a){return this.stripTags(this.stripControl(a))},encodeName:function(a){return a&&"string"==typeof a&&(a=a.replace(/[\s!@#$%^&*()"'\\<>,;.:/+]/g,"_").toLowerCase()),a},translate:function(a,b,c){var d,e="";return a&&"string"==typeof a?(a=a.toUpperCase(),"object"==typeof SB?(c=document.documentElement.getAttribute("lang"),d=function(a,b,c){var d=SB.getByClass(b,SB.getByTag("main")[0],"section")[0];return a=a.replace("{{i18n_","").replace("}}",""),d.dataset&&d.dataset["string"+a.charAt(0)+a.substr(1).toLowerCase()]?a=d.dataset["string"+a.charAt(0)+a.substr(1).toLowerCase()]:SB.spec.strings[a]&&(a=SB.spec.strings[a]),a}):d=require(__dirname+"/translate").translate,e=d("{{i18n_"+a+"}}",b,c)):e=a,e},arrayList:function(a,b,c){var d="",e=0;for(e;e<a.length;e+=1)e&&(e===a.length-1?d=d+" "+this.translate("AND",b,c)+" ":d+=", "),d+=a[e];return d},displayRelativeTime:function(a){var b,c={day:86400,hour:3600,minute:60,second:1},d={day:"00",hour:"00",minute:"00",second:"00"};for(b in c)a>=c[b]&&(d[b]=Math.floor(a/c[b]),d[b]<10&&(d[b]="0"+d[b]),a-=d[b]*c[b]);return d.day+" "+d.hour+":"+d.minute+":"+d.second},displayTime:function(a,b,c,d){var e=d||new Date(a),f=e.getDate(),g=e.getDay(),h={0:"sun",1:"mon",2:"tue",3:"wed",4:"thur",5:"fri",6:"sat"},i=e.getHours(),j=e.getMinutes(),k=b("am"),l="";switch(i>12&&(i-=12,k=b("pm")),i=0===i?12:i,10>j&&(j="0"+j),g=b(h[g]),c){case"long":l=g+" "+f+" @ "+i+":"+j+k;break;default:l=g+" @ "+i+":"+j+k}return l}}}("undefined"==typeof exports?this.SB:exports);